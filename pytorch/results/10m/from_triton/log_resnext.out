Downloading: "https://download.pytorch.org/models/resnext50_32x4d-7cdf4587.pth" to /home/hiremas1/.cache/torch/hub/checkpoints/resnext50_32x4d-7cdf4587.pth
  0%|          | 0.00/95.8M [00:00<?, ?B/s]  5%|▍         | 4.71M/95.8M [00:00<00:01, 49.4MB/s] 10%|█         | 10.0M/95.8M [00:00<00:01, 51.1MB/s] 21%|██        | 20.0M/95.8M [00:00<00:01, 60.4MB/s] 28%|██▊       | 27.3M/95.8M [00:00<00:01, 64.4MB/s] 34%|███▍      | 32.8M/95.8M [00:00<00:01, 61.4MB/s] 40%|███▉      | 38.3M/95.8M [00:00<00:01, 57.2MB/s] 45%|████▌     | 43.5M/95.8M [00:00<00:01, 52.4MB/s] 51%|█████     | 48.5M/95.8M [00:00<00:01, 47.7MB/s] 55%|█████▌    | 53.0M/95.8M [00:01<00:01, 42.4MB/s] 60%|█████▉    | 57.2M/95.8M [00:01<00:00, 41.1MB/s] 64%|██████▍   | 61.2M/95.8M [00:01<00:00, 39.5MB/s] 68%|██████▊   | 65.1M/95.8M [00:01<00:00, 38.8MB/s] 72%|███████▏  | 68.8M/95.8M [00:01<00:00, 38.8MB/s] 76%|███████▌  | 72.6M/95.8M [00:01<00:00, 38.7MB/s] 80%|███████▉  | 76.3M/95.8M [00:01<00:00, 38.5MB/s] 84%|████████▎ | 80.0M/95.8M [00:01<00:00, 38.0MB/s] 87%|████████▋ | 83.6M/95.8M [00:01<00:00, 37.9MB/s] 91%|█████████ | 87.3M/95.8M [00:01<00:00, 37.8MB/s] 95%|█████████▌| 91.0M/95.8M [00:02<00:00, 38.1MB/s] 99%|█████████▉| 94.7M/95.8M [00:02<00:00, 38.2MB/s]100%|██████████| 95.8M/95.8M [00:02<00:00, 45.5MB/s]Namespace(bs=64, gpu=True, model_name='resnext', num_epochs=50, patience=5, test_dir='data/test/', train_dir='data/train_wa/', valid_dir='data/valid/')

ep:0/50|et:19|losstr:0.51788|lossva:0.26668|accva:0.90193|aucva:0.95619|f1va:0.84135|p1va:0.88832|r1va:0.79909|
ep:1/50|et:16|losstr:0.23161|lossva:0.38735|accva:0.86627|aucva:0.93061|f1va:0.76064|p1va:0.91083|r1va:0.65297|
ep:2/50|et:16|losstr:0.11754|lossva:0.31597|accva:0.89450|aucva:0.94905|f1va:0.84045|p1va:0.82743|r1va:0.85388|
ep:3/50|et:16|losstr:0.10286|lossva:0.41089|accva:0.89004|aucva:0.93702|f1va:0.83333|p1va:0.82222|r1va:0.84475|
ep:4/50|et:16|losstr:0.06451|lossva:0.56321|accva:0.87519|aucva:0.91994|f1va:0.79512|p1va:0.85340|r1va:0.74429|
ep:5/50|et:16|losstr:0.09833|lossva:2.37078|accva:0.65527|aucva:0.92856|f1va:0.64955|p1va:0.48533|r1va:0.98174|
ep:6/50|et:16|losstr:0.04969|lossva:0.36239|accva:0.89896|aucva:0.94671|f1va:0.83333|p1va:0.89947|r1va:0.77626|
ep:7/50|et:16|losstr:0.05649|lossva:0.38288|accva:0.87816|aucva:0.94733|f1va:0.81858|p1va:0.79399|r1va:0.84475|
ep:8/50|et:16|losstr:0.07991|lossva:0.84725|accva:0.80535|aucva:0.93624|f1va:0.75048|p1va:0.64379|r1va:0.89954|
ep:9/50|et:16|losstr:0.03685|lossva:0.40301|accva:0.87964|aucva:0.93257|f1va:0.81716|p1va:0.80804|r1va:0.82648|
ep:10/50|et:16|losstr:0.02029|lossva:0.39417|accva:0.89450|aucva:0.92674|f1va:0.83135|p1va:0.86634|r1va:0.79909|
ep:11/50|et:16|losstr:0.00743|lossva:0.56689|accva:0.87964|aucva:0.94730|f1va:0.82581|p1va:0.78049|r1va:0.87671|
ep:12/50|et:16|losstr:0.05075|lossva:0.65919|accva:0.86181|aucva:0.89382|f1va:0.74933|p1va:0.91447|r1va:0.63470|
ep:13/50|et:16|losstr:0.06789|lossva:0.51158|accva:0.87816|aucva:0.92519|f1va:0.79293|p1va:0.88701|r1va:0.71689|
ep:14/50|et:16|losstr:0.02385|lossva:0.50014|accva:0.87667|aucva:0.94727|f1va:0.82227|p1va:0.77419|r1va:0.87671|
ep:15/50|et:16|losstr:0.00846|lossva:0.39573|accva:0.89747|aucva:0.95592|f1va:0.83688|p1va:0.86765|r1va:0.80822|
ep:16/50|et:16|losstr:0.00722|lossva:0.47329|accva:0.89153|aucva:0.95629|f1va:0.84026|p1va:0.80672|r1va:0.87671|
ep:17/50|et:16|losstr:0.00663|lossva:0.42046|accva:0.89302|aucva:0.92928|f1va:0.83019|p1va:0.85854|r1va:0.80365|
ep:18/50|et:16|losstr:0.00188|lossva:0.43687|accva:0.89153|aucva:0.92583|f1va:0.81975|p1va:0.89247|r1va:0.75799|
ep:19/50|et:16|losstr:0.00126|lossva:0.42268|accva:0.89004|aucva:0.93973|f1va:0.82381|p1va:0.86070|r1va:0.78995|
ep:20/50|et:16|losstr:0.00065|lossva:0.44184|accva:0.89302|aucva:0.93914|f1va:0.82439|p1va:0.88482|r1va:0.77169|
=========================stopping early=========================
=========================best at ep15=========================
=========================retraining using all data=========================
ep:0/15|losstr:0.19845
ep:1/15|losstr:0.07795
ep:2/15|losstr:0.03010
ep:3/15|losstr:0.03611
ep:4/15|losstr:0.04293
ep:5/15|losstr:0.02714
ep:6/15|losstr:0.03638
ep:7/15|losstr:0.01765
ep:8/15|losstr:0.01470
ep:9/15|losstr:0.02017
ep:10/15|losstr:0.02787
ep:11/15|losstr:0.01379
ep:12/15|losstr:0.01485
ep:13/15|losstr:0.05413
ep:14/15|losstr:0.03965
=========================test performance=========================
losste:0.25601|accte:0.93659|aucte:0.92890|f1te:0.77707|p1te:0.83562|r1te:0.72619|
